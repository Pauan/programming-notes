.fs.nu
[source]
----
(USE {} = "nulan:Task")
(USE {} = "nulan:Stream")

(TYPE Stat)

(EXPORT { read-file! = read_file
          write-file! = write_file
          rename-file! = rename_file
          symlink!
          real-path = real_path
          remove-file! = remove_file
          remove-directory! = remove_directory
          make-directory! = make_directory
          # TODO maybe use a Stream rather than a List, in case the directory is very huge ?
          files-from-directory = files_from_directory
          files-from-directory-recursive = files_from_directory_recursive }

  (FFI-IMPORT "fs"
    (read_file :: (-> String (Stream String) (Task Void)))

    (write_file :: (-> (Stream String) String (Task Void)))

    (rename_file :: (-> String String (Task Void)))

    (stat_file :: (-> String (Task Stat)))

    (symlink :: (-> String String (Task Void)))

    (real_path :: (-> String (Task String)))

    (remove_file :: (-> String (Task Void)))

    (remove_directory :: (-> String (Task Void)))

    (make_directory :: (-> String (Task Void)))

    (files_from_directory :: (-> String (Task (List String))))

    (files_from_directory_recursive :: (-> String (Task (List String))))))

# TODO maybe allow for passing in a stream which will be used instead of creating a new one?
(FUNCTION
  (copy-file! :: (-> String String (Task Void)))
  (copy-file! from to)
    (DO s = (stream)
      (ignore-concurrent
        (read-file! from s)
        (write-file! s to))))
----
